"use strict";(globalThis.webpackChunkmy_book=globalThis.webpackChunkmy_book||[]).push([[8401],{2691:(t,n,a)=>{a.r(n),a.d(n,{default:()=>u});var o=a(6540),e=a(8310),r=a(5475),i=a(4586),s=a(4164),l=a(8774),c=a(7941),d=a(3092),m=a(4848);function u(t){const{user:n,loading:a}=(0,r.A)(),{siteConfig:u}=(0,i.A)(),h=u.customFields.backendUrl,[p,g]=(0,o.useState)(""),[b,z]=(0,o.useState)(""),[f,x]=(0,o.useState)(""),[w,j]=(0,o.useState)({personalization:!1,translation:!1}),[y,k]=(0,o.useState)({personalization:null,translation:null}),[v,N]=(0,o.useState)("original"),{content:C}=t,$=C.metadata.source;(0,o.useEffect)(()=>{!n||p||y.personalization||y.translation||(async()=>{try{const t=$.replace(/^@site/,""),n=`${u.baseUrl.replace(/\/$/,"")}${t}`,a=await fetch(n);if(!a.ok)throw new Error(`Failed to fetch raw content from ${n}: ${a.statusText}`);const o=await a.text();g(o)}catch(t){console.error("Error fetching raw content:",t),k(t=>({...t,personalization:"Could not load original content for personalization.",translation:"Could not load original content for translation."}))}})()},[$,n,u.baseUrl,p,y.personalization,y.translation]);const S=async t=>{const n="personalize"===t,a=n?`/api/v1/chapters/${A()}/personalized`:"/api/v1/translate";j(t=>({...t,[n?"personalization":"translation"]:!0})),k(t=>({...t,[n?"personalization":"translation"]:null}));try{if(!p)throw new Error("Original content not loaded yet.");const o=localStorage.getItem("access_token");if(!o)return void(window.location.href="/login");const e=await fetch(`${h}${a}`,{method:n?"GET":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:n?void 0:JSON.stringify({content:p})});if(!e.ok){const n=await e.json();throw new Error(n.detail||`${t} failed`)}const r=await e.json();n?(z(r.personalized_content),N("personalized")):(x(r.translated_content),N("translated"))}catch(o){console.error(`${t} error:`,o),k(t=>({...t,[n?"personalization":"translation"]:o.message}))}finally{j(t=>({...t,[n?"personalization":"translation"]:!1}))}},A=()=>{const t=$.match(/\/docs\/(.+?)\.(md|mdx)$/);if(!t)throw new Error("Could not extract chapter ID from document path.");return t[1]};return a||n?(0,m.jsxs)(m.Fragment,{children:[n&&(0,m.jsxs)("div",{className:"margin-bottom--md button-group",children:["original"!==v&&(0,m.jsx)("button",{className:"button button--secondary button--sm margin-right--sm",onClick:()=>N("original"),children:"Show Original"}),"personalized"!==v&&(0,m.jsx)("button",{className:"button button--primary button--sm margin-right--sm",onClick:()=>S("personalize"),disabled:w.personalization||!p,children:w.personalization?"Personalizing...":"Personalize Chapter"}),"translated"!==v&&(0,m.jsx)("button",{className:"button button--primary button--sm",onClick:()=>S("translate"),disabled:w.translation||!p,children:w.translation?"Translating...":"Translate to Urdu"}),y.personalization&&(0,m.jsxs)("div",{className:"alert alert--danger margin-top--sm",children:["Personalization Error: ",y.personalization]}),y.translation&&(0,m.jsxs)("div",{className:"alert alert--danger margin-top--sm",children:["Translation Error: ",y.translation]})]}),"original"===v&&(0,m.jsx)(e.A,{...t}),"personalized"===v&&b&&(0,m.jsx)("div",{className:"markdown",children:(0,m.jsx)(c.oz,{remarkPlugins:[d.A],children:b})}),"translated"===v&&f&&(0,m.jsx)("div",{className:(0,s.A)("markdown","rtl-content"),children:(0,m.jsx)(c.oz,{remarkPlugins:[d.A],children:f})})]}):(0,m.jsx)("div",{className:"hero hero--primary",style:{backgroundColor:"var(--ifm-color-primary-darkest)",minHeight:"80vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,m.jsxs)("div",{className:"container text--center",children:[(0,m.jsx)("h1",{className:"hero__title",children:"Access Denied"}),(0,m.jsx)("p",{className:"hero__subtitle",children:"You must be logged in to view this content."}),(0,m.jsx)("div",{className:"margin-top--md",children:(0,m.jsx)(l.A,{className:"button button--secondary button--lg",to:"/login",children:"Login to continue"})})]})})}}}]);