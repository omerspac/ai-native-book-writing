openapi: 3.0.0
info:
  title: AI-Native Book Platform API
  version: 1.0.0
  description: API for managing the AI-Native Book Platform, including authentication, content, and interactive features.

paths:
  /auth/signup:
    post:
      summary: User Signup
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
                profile:
                  type: object
                  properties:
                    experience_level:
                      type: string
                      enum: ["Beginner", "Intermediate", "Expert"]
                    learning_goal:
                      type: string
      responses:
        '201':
          description: User created successfully

  /auth/login:
    post:
      summary: User Login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Login successful, returns access token.

  /users/me:
    get:
      summary: Get Current User Profile
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Returns the current user's profile information.

  /chapters/{chapter_id}:
    get:
      summary: Get a Chapter
      parameters:
        - name: chapter_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Returns the base content of a specific chapter.

  /chapters/{chapter_id}/personalized:
    get:
      summary: Get Personalized Chapter
      security:
        - bearerAuth: []
      parameters:
        - name: chapter_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Returns a personalized version of the chapter for the logged-in user.

  /chat:
    post:
      summary: Interact with the RAG Chatbot
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                question:
                  type: string
      responses:
        '200':
          description: Returns the chatbot's answer.

  /translate:
    post:
      summary: Translate Text to Urdu
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                text:
                  type: string
      responses:
        '200':
          description: Returns the translated text.

  /plans:
    get:
      summary: List All Plans
      security:
        - bearerAuth: []
      responses:
        '200':
          description: A list of plans owned by the user.
    post:
      summary: Create a New Plan
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Plan'
      responses:
        '201':
          description: Plan created successfully.

  /plans/{plan_id}:
    get:
      summary: Get a Specific Plan
      security:
        - bearerAuth: []
      parameters:
        - name: plan_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: The requested plan.
    put:
      summary: Update a Plan
      security:
        - bearerAuth: []
      parameters:
        - name: plan_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Plan'
      responses:
        '200':
          description: Plan updated successfully.

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
  schemas:
    PlanStep:
      type: object
      properties:
        name:
          type: string
        prompt:
          type: string
        status:
          type: string
          enum: ["Pending", "InProgress", "Completed", "Failed"]
    Plan:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        steps:
          type: array
          items:
            $ref: '#/components/schemas/PlanStep'
